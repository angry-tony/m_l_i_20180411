
classes:
  # Services
  - system.docker.client
  # Docker services
  - system.docker.swarm.stack.docker
  - system.docker.swarm.stack.gerrit
  - system.docker.swarm.stack.jenkins
  - system.docker.swarm.stack.ldap

  # Jenkins
  - system.jenkins.master.config
  - system.jenkins.client
  - system.jenkins.client.credential.gerrit
  - system.jenkins.client.credential.salt
  # Jobs
  - system.jenkins.client.job.git-mirrors.downstream.pipelines
  - system.jenkins.client.job.deploy.openstack
  - system.jenkins.client.job.deploy.update
  - system.jenkins.client.job.ceph
  # Security
  - system.jenkins.client.security.ldap
  - system.jenkins.client.security.matrix
  # Slaves
  - system.jenkins.client.node
  # OpenLDAP
  - system.openldap.client
  - system.openldap.client.people.admin

  # Gerrit
  - system.gerrit.client
  - system.gerrit.client.project.ci

  - system.docker.swarm.master

  - cluster.snv.infra
  - cluster.snv.cicd.control

parameters:
  _param:
    # Jenkins
    jenkins_slave_user: admin
    jenkins_client_user: admin
    jenkins_slave_password: ${_param:jenkins_admin_password}
    jenkins_client_password: ${_param:jenkins_admin_password}
    jenkins_admin_email: ${_param:admin_email}
    aptly_api_port: 8080
    aptly_public_port: 80
    jenkins_admin_public_key: ssh-rsa AAAAB3NzaC1yc2EAAAADAQABAAABAQC1gAa/XfbHcAff8Fv4ZiWp6Db1CT/X6T4xfCa1R/+y5TjR2FUoH8bDRE+Y0C9LeLkKdqALyjoOFIYDjETFSDSB9vG1HzTviVvPhngagAK5Nwy0k2JyFuTvuZUlkPfUBksCTHsSgGtB6ERzXBImAHjl3FBer4iLpkj2qT8v9Z1ApZKpS1MIvchuquYTks2FviilBI61ALg9jktQzIrG2nYveaw+TwNTN00h7egW3WUbmvJUQ8kLHWFrQbTJLTej7nbjCjlsAKOkKouMYx2ZvCTq9lvDZJh9hUV0+UXPFMMcDtS98Zkz0uokK5oIq6t8VAao6jFOH6nieJGQGLajBZwp
    jenkins_admin_private_key: |
      -----BEGIN RSA PRIVATE KEY-----
      MIIEogIBAAKCAQEAtYAGv132x3AH3/Bb+GYlqeg29Qk/1+k+MXwmtUf/suU40dhV
      KB/Gw0RPmNAvS3i5CnagC8o6DhSGA4xExUg0gfbxtR8074lbz4Z4GoACuTcMtJNi
      chbk77mVJZD31AZLAkx7EoBrQehEc1wSJgB45dxQXq+Ii6ZI9qk/L/WdQKWSqUtT
      CL3IbqrmE5LNhb4opQSOtQC4PY5LUMyKxtp2L3msPk8DUzdNIe3oFt1lG5ryVEPJ
      Cx1ha0G0yS03o+524wo5bACjpCqLjGMdmbwk6vZbw2SYfYVFdPlFzxTDHA7UvfGZ
      M9LqJCuaCKurfFQGqOoxTh+p4niRkBi2owWcKQIDAQABAoIBAGNmfkuH9oM7Q9TN
      GlFr/+yRlKeWLTTeNIV9bOWTTOJ4zyl9xQV4ga6nVsBmI8C9mPm2BejvE+RqMQr4
      YyF4belPiQic0qztGS8KgfRhbxxonbi3jw7UowT3KkusnU2tNJ9Jq41yb0tlHTfg
      kL/nOk8I3as9jxaMNyF/h2+IoFqqZl0PeLKnhrzpwIPsVQGGCTjl3fChkxdmbpmA
      ccpXloTxMnZqMFq/m7F5Z1xZjDWjD6q6h5il5hgi8opA6YTCbTNQ10bEHfCzHWdZ
      X2qnFy2zwqyCX3cNKgRebikX0nxiK67BF344LTUk2PHIqaK5V9GNVzZg9Skj/fQR
      6wKfbgECgYEA6NcIpU6MZEOX9YHzpE7JUk3DzqCc0CAiUR6hd/EOALGVTCTi4Zcb
      lCBAkeK4OyyhkL1aUDI23GBHNXtuVTOrZLf5qN4maXETOoKUMWt5adZKC/8HOJ6/
      SRpKEZjePI2GA0EbQ8/V9XZ7TfeITxSBSGMly3z7fc4DL8zvjNGG4pkCgYEAx42w
      kFODAXrP2vz5ZRYC03A5JB3dnih7BuRuRFCcUpiDPCAt6qL5PbEoUuG3JeNWzsoq
      MKwRsdINvGgN4sTam8jg2A2dQO1FQ3DA3bc+d3zJaNfQlDZxEqAQ9VXAyQBzP8c1
      ouleTek3V+qrDc9HyKpTyMLYtqnym06Whol/EBECgYB8h311RARsH4anZMBVMVoV
      Lcg6u8YCvhz8e8BqML+HeXLbDaNWegXi/DjsjXBxHZavncYuvByBUvDi1sgUw5S4
      QnlBasbqf/KDyZDOuadvBpAFyHkpPCYcR/YzYSoDAsIY/XpCk2bgaGTcNzZs7Q+U
      EosFQSwUhdlIeHfqPanBiQKBgAwPk0FV2tAnFRL+QTCL4QXYfYuiRne9qJnlCokU
      ei4/y4bBxySsTvYck/xWahRfJir/awdgDv25XV0qyNQQ48mQnY5RXFTFQm9uDCoa
      Xisonp+4k4GxvKnMhNnfIfTEEzMinipHgoyg8NhedZIzGfqV2NSEekaoBOLAIDbn
      boeRAoGAGRF4kAwSsnAciHJFwglrMA/bVO0W1r4o5zdQjHdvAjbfBkReSjNaOXC7
      QM5yLQFtOZnTuzMs5P1+CNX+CWNOHq7HkmzIB3R/THarRpDzHdvBTOcExeDX1ksB
      gIkiplDxVsB/Y8SjaUnj5YbfNU/1KdZiyaLOopwbRoDXAslG6aU=
      -----END RSA PRIVATE KEY-----
    # Jobs params
    jenkins_gerrit_url: ssh://admin@${_param:haproxy_gerrit_bind_host}:${_param:haproxy_gerrit_ssh_bind_port}

    # Gerrit
    gerrit_admin_email: ${_param:admin_email}
    gerrit_public_host: https://${_param:nginx_proxy_gerrit_server_site_host}:${_param:nginx_proxy_gerrit_server_site_port}
    gerrit_admin_public_key: ${_param:jenkins_admin_public_key}
    gerrit_admin_private_key: ${_param:jenkins_admin_private_key}
    gerrit_auth_type: LDAP
    gerrit_ldap_server: "ldap://${_param:cluster_vip_address}"
    gerrit_ldap_bind_user: "cn=admin,${_param:openldap_dn}"
    gerrit_ldap_bind_password: ${_param:openldap_admin_password}
    gerrit_ldap_account_base: ou=people,${_param:openldap_dn}
    gerrit_ldap_group_base: ou=groups,${_param:openldap_dn}
  jenkins:
    client:
      lib:
        pipeline-library:
          branch: ${_param:jenkins_pipelines_branch}
